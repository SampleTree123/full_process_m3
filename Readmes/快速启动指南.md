# å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸš€ 5åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹

### æ­¥éª¤ 1: å¯åŠ¨ API æœåŠ¡

```bash
# å¯åŠ¨åŸç‰ˆæœåŠ¡ï¼ˆGPU 0ï¼Œç«¯å£ 5000-5002ï¼‰
nohup python start_services.py --action start --api_version original > api_start_ori.log 2>&1 &

# ç­‰å¾…æœåŠ¡å¯åŠ¨ï¼ˆçº¦30-60ç§’ï¼‰
sleep 60

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
python start_services.py --action status --api_version original
```

**é¢„æœŸè¾“å‡º**:
```
âœ… Preprocess API (http://localhost:5000) - è¿è¡Œä¸­
âœ… OSEDiff API (http://localhost:5001) - è¿è¡Œä¸­  
âœ… Quality API (http://localhost:5002) - è¿è¡Œä¸­
```

---

### æ­¥éª¤ 2: è¿è¡Œä¸»ç¨‹åº

#### é€‰é¡¹ A: å¿«é€Ÿæµ‹è¯•ï¼ˆæ¨èæ–°æ‰‹ï¼‰

```bash
# å¤„ç† 5 å¯¹å›¾åƒï¼Œä½¿ç”¨ 4 ä¸ªæ’å€¼ï¼ˆå¿«é€Ÿï¼‰
python main.py \
  --input_dirs /path/to/your/panoramas \
  --sample_n 5 \
  --output_dir test_output \
  --api_version original \
  --num_interpolations 4 \
  --random_seed 42
```

#### é€‰é¡¹ B: æ ‡å‡†å¤„ç†

```bash
# æŒç»­å¤„ç†ç›´åˆ°è·å¾— 100 ä¸ªæœ‰æ•ˆç»“æœï¼Œä½¿ç”¨ 9 ä¸ªæ’å€¼ï¼ˆæ ‡å‡†ï¼‰
python main.py \
  --input_dirs /path/to/panoramas1 /path/to/panoramas2 \
  --target_n 100 \
  --output_dir output \
  --api_version original \
  --num_interpolations 9 \
  --random_seed 42
```

#### é€‰é¡¹ C: é«˜è´¨é‡å¤„ç†

```bash
# å¤„ç† 10 å¯¹å›¾åƒï¼Œä½¿ç”¨ 19 ä¸ªæ’å€¼ï¼ˆé«˜è´¨é‡ï¼‰
python main.py \
  --input_dirs /path/to/panoramas \
  --sample_n 10 \
  --output_dir output_hq \
  --api_version original \
  --num_interpolations 19 \
  --random_seed 42
```

---

### æ­¥éª¤ 3: ç›‘æ§è¿›åº¦

```bash
# æŸ¥çœ‹å¤„ç†æ—¥å¿—
tail -f test_output/panorama_processing.log

# æŸ¥çœ‹å½“å‰ç»“æœæ•°é‡
cat test_output/results.json | grep "group_id" | wc -l

# æŸ¥çœ‹ GPU ä½¿ç”¨æƒ…å†µ
nvidia-smi
```

---

### æ­¥éª¤ 4: æŸ¥çœ‹ç»“æœ

```bash
# æŸ¥çœ‹ç»“æœæ–‡ä»¶
ls -lh test_output/results.json

# æŸ¥çœ‹ç”Ÿæˆçš„ç›®å½•ç»“æ„
tree -L 2 test_output/

# æŸ¥çœ‹æŸä¸ªç»„çš„è¯¦ç»†ä¿¡æ¯
cat test_output/group_0001/group_info.json
```

**è¾“å‡ºç›®å½•ç»“æ„**:
```
test_output/
â”œâ”€â”€ results.json                    # æœ€ç»ˆç»“æœ JSON
â”œâ”€â”€ panorama_processing.log         # å¤„ç†æ—¥å¿—
â”œâ”€â”€ group_0001/                     # ç¬¬ä¸€ä¸ªå›¾åƒç»„
â”‚   â”œâ”€â”€ preprocess/                 # é¢„å¤„ç†å›¾åƒå¯¹
â”‚   â”œâ”€â”€ osediff/                    # è¶…åˆ†åå›¾åƒå¯¹
â”‚   â”œâ”€â”€ interpolated/               # æ’å€¼å›¾åƒ
â”‚   â”œâ”€â”€ interpolated_sr/            # è¶…åˆ†åæ’å€¼å›¾åƒ
â”‚   â”œâ”€â”€ descriptions/               # æè¿°æ–‡ä»¶
â”‚   â””â”€â”€ group_info.json            # ç»„ä¿¡æ¯
â”œâ”€â”€ group_0002/                     # ç¬¬äºŒä¸ªå›¾åƒç»„
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
```

---

## ğŸ“ å‘½ä»¤è¡Œå‚æ•°é€ŸæŸ¥è¡¨

| å‚æ•° | å¿…éœ€ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| `--input_dirs` | âœ… | - | è¾“å…¥å›¾åƒæ–‡ä»¶å¤¹ï¼ˆå¯å¤šä¸ªï¼‰ |
| `--output_dir` | âŒ | `output` | è¾“å‡ºç›®å½• |
| `--sample_n` | *ï¸âƒ£ | - | å›ºå®šé‡‡æ ·æ•°é‡ |
| `--target_n` | *ï¸âƒ£ | - | ç›®æ ‡è¾“å‡ºæ•°é‡ |
| `--num_interpolations` | âŒ | `9` | æ’å€¼å›¾åƒæ•°é‡ |
| `--random_seed` | âŒ | `42` | éšæœºç§å­ |
| `--api_version` | âŒ | `original` | APIç‰ˆæœ¬ |

*ï¸âƒ£ `--sample_n` å’Œ `--target_n` äºŒé€‰ä¸€å¿…å¡«

---

## ğŸ¯ å¸¸è§ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: å¿«é€ŸéªŒè¯æµç¨‹

```bash
# æœ€å°é…ç½®ï¼Œå¿«é€Ÿæµ‹è¯•
python main.py \
  --input_dirs ./test_images \
  --sample_n 1 \
  --num_interpolations 4
```

**é¢„æœŸæ—¶é—´**: çº¦ 30 ç§’  
**ç”Ÿæˆæ–‡ä»¶**: 6 å¼ å›¾åƒ/å¯¹

---

### åœºæ™¯ 2: æ ‡å‡†è§†é¢‘ç”Ÿæˆ

```bash
# é€‚åˆç”Ÿæˆ 30fps è§†é¢‘
python main.py \
  --input_dirs ./panoramas \
  --sample_n 100 \
  --num_interpolations 9 \
  --output_dir video_output
```

**é¢„æœŸæ—¶é—´**: çº¦ 30 åˆ†é’Ÿï¼ˆ100å¯¹ï¼‰  
**ç”Ÿæˆæ–‡ä»¶**: 1,100 å¼ å›¾åƒï¼ˆ11å¼ /å¯¹ Ã— 100ï¼‰

---

### åœºæ™¯ 3: é«˜è´¨é‡ç”µå½±çº§è¾“å‡º

```bash
# é€‚åˆç”Ÿæˆ 60fps é«˜è´¨é‡è§†é¢‘
python main.py \
  --input_dirs ./hq_panoramas \
  --sample_n 50 \
  --num_interpolations 29 \
  --output_dir cinema_output
```

**é¢„æœŸæ—¶é—´**: çº¦ 50 åˆ†é’Ÿï¼ˆ50å¯¹ï¼‰  
**ç”Ÿæˆæ–‡ä»¶**: 1,550 å¼ å›¾åƒï¼ˆ31å¼ /å¯¹ Ã— 50ï¼‰

---

### åœºæ™¯ 4: å¤§è§„æ¨¡æ‰¹é‡å¤„ç†

```bash
# æŒç»­å¤„ç†ç›´åˆ°è¾¾åˆ°ç›®æ ‡æ•°é‡
nohup python main.py \
  --input_dirs /data/panos1 /data/panos2 /data/panos3 \
  --target_n 10000 \
  --num_interpolations 9 \
  --output_dir big_batch \
  --random_seed 2001 \
  > process.log 2>&1 &
```

**é¢„æœŸæ—¶é—´**: æ•°å°æ—¶è‡³æ•°å¤©  
**åå°è¿è¡Œ**: âœ…

---

## âš™ï¸ æ’å€¼æ•°é‡é€‰æ‹©æŒ‡å—

| æ•°é‡ | æ€»å›¾åƒ/å¯¹ | é€‚ç”¨åœºæ™¯ | å¤„ç†æ—¶é—´ | è´¨é‡ |
|-----|----------|---------|---------|------|
| 4 | 6 | å¿«é€Ÿæµ‹è¯•/åŸå‹ | âš¡ æœ€å¿« | â­â­ |
| 9 (é»˜è®¤) | 11 | æ ‡å‡†è§†é¢‘ | âš¡âš¡ å¿« | â­â­â­ |
| 19 | 21 | é«˜è´¨é‡è§†é¢‘ | âš¡âš¡âš¡ ä¸­ç­‰ | â­â­â­â­ |
| 29+ | 31+ | ç”µå½±çº§/æè‡´å¹³æ»‘ | âš¡âš¡âš¡âš¡ æ…¢ | â­â­â­â­â­ |

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: æœåŠ¡æ— æ³•å¯åŠ¨

**ç—‡çŠ¶**: 
```
âŒ Preprocess API (http://localhost:5000) - æ— æ³•è¿æ¥
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep 5000

# 2. æŸ¥çœ‹æœåŠ¡æ—¥å¿—
tail -f api_start_ori.log

# 3. æ‰‹åŠ¨æ€æ­»å ç”¨è¿›ç¨‹
kill -9 <PID>

# 4. é‡æ–°å¯åŠ¨æœåŠ¡
python start_services.py --action stop --api_version original
python start_services.py --action start --api_version original
```

---

### é—®é¢˜ 2: å¤„ç†é€Ÿåº¦æ…¢

**ç—‡çŠ¶**: å¤„ç†é€Ÿåº¦ä½äºé¢„æœŸ

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. å‡å°‘æ’å€¼æ•°é‡
--num_interpolations 4  # æ”¹ä¸º 4

# 2. æ£€æŸ¥ GPU ä½¿ç”¨ç‡
nvidia-smi

# 3. æ£€æŸ¥ç£ç›˜ I/O
iostat -x 1

# 4. ä½¿ç”¨å›ºå®šé‡‡æ ·è€Œéç›®æ ‡æ•°é‡
--sample_n 10  # è€Œé --target_n 10000
```

---

### é—®é¢˜ 3: ç£ç›˜ç©ºé—´ä¸è¶³

**ç—‡çŠ¶**: 
```
OSError: [Errno 28] No space left on device
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ¸…ç†ä¸­é—´æ–‡ä»¶
rm -rf output/group_*/osediff/

# 2. å‡å°‘æ’å€¼æ•°é‡
--num_interpolations 4

# 3. ä½¿ç”¨æ›´å°çš„é‡‡æ ·æ•°é‡
--sample_n 10
```

---

### é—®é¢˜ 4: å†…å­˜ä¸è¶³

**ç—‡çŠ¶**: 
```
RuntimeError: CUDA out of memory
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. é‡å¯ API æœåŠ¡é‡Šæ”¾æ˜¾å­˜
python start_services.py --action stop --api_version original
python start_services.py --action start --api_version original

# 2. ä½¿ç”¨è¾ƒå°çš„æ‰¹å¤„ç†ï¼ˆä¿®æ”¹ API é…ç½®ï¼‰

# 3. ä»…ä½¿ç”¨ä¸€ä¸ª GPU
# åœæ­¢å¦ä¸€ä¸ªç‰ˆæœ¬çš„æœåŠ¡
python start_services.py --action stop --api_version shared_left
```

---

## ğŸ“Š æ€§èƒ½åŸºå‡†

åŸºäºæµ‹è¯•ç¯å¢ƒï¼ˆNVIDIA RTX 3090, 24GB VRAMï¼‰ï¼š

| é…ç½® | å•å¯¹å¤„ç†æ—¶é—´ | ååé‡ | ç£ç›˜å ç”¨/å¯¹ |
|-----|------------|--------|------------|
| 4 ä¸ªæ’å€¼ | ~8 ç§’ | 7.5 å¯¹/åˆ†é’Ÿ | ~8 MB |
| 9 ä¸ªæ’å€¼ (é»˜è®¤) | ~18 ç§’ | 3.3 å¯¹/åˆ†é’Ÿ | ~18 MB |
| 19 ä¸ªæ’å€¼ | ~38 ç§’ | 1.6 å¯¹/åˆ†é’Ÿ | ~38 MB |
| 29 ä¸ªæ’å€¼ | ~58 ç§’ | 1.0 å¯¹/åˆ†é’Ÿ | ~58 MB |

---

## ğŸ“ è¿›é˜¶ç”¨æ³•

### åŒ GPU å¹¶è¡Œå¤„ç†

```bash
# Terminal 1: GPU 0
nohup python main.py \
  --input_dirs /data/panos \
  --target_n 5000 \
  --output_dir output_gpu0 \
  --api_version original \
  --random_seed 2001 \
  > gpu0.log 2>&1 &

# Terminal 2: GPU 1  
nohup python main.py \
  --input_dirs /data/panos \
  --target_n 5000 \
  --output_dir output_gpu1 \
  --api_version shared_left \
  --random_seed 2002 \
  > gpu1.log 2>&1 &
```

**ä¼˜åŠ¿**: 2å€ååé‡ï¼Œç‹¬ç«‹çš„éšæœºç§å­é¿å…é‡å¤

---

### è‡ªå®šä¹‰è¾“å…¥ç›®å½•

```bash
# æ··åˆå¤šä¸ªæ•°æ®é›†
python main.py \
  --input_dirs \
    /data/dataset1/panoramas \
    /data/dataset2/images \
    /data/dataset3/captures \
  --sample_n 100 \
  --output_dir mixed_output
```

---

### ä½¿ç”¨ç»å¯¹è·¯å¾„

```bash
# æ‰€æœ‰è·¯å¾„éƒ½ä½¿ç”¨ç»å¯¹è·¯å¾„
python main.py \
  --input_dirs /home/user/data/panoramas \
  --output_dir /home/user/output \
  --sample_n 50
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **æ’å€¼æ•°é‡å‚æ•°ä½¿ç”¨è¯´æ˜.md** - æ’å€¼å‚æ•°è¯¦ç»†æ–‡æ¡£
- **å›¾åƒä¼ é€’æ–¹å¼åˆ†æ.md** - ç³»ç»Ÿæ¶æ„åˆ†æ
- **å¯åŠ¨.txt** - å®Œæ•´çš„å¯åŠ¨å‘½ä»¤å‚è€ƒ
- **config/api_config.py** - é…ç½®æ–‡ä»¶è¯´æ˜

---

## ğŸ’¡ æœ€ä½³å®è·µ

1. **é¦–æ¬¡ä½¿ç”¨**: ä½¿ç”¨ `--sample_n 1 --num_interpolations 4` å¿«é€ŸéªŒè¯
2. **æ€§èƒ½è°ƒä¼˜**: æ ¹æ® GPU å’Œç£ç›˜æƒ…å†µé€‰æ‹©åˆé€‚çš„æ’å€¼æ•°é‡
3. **é•¿æ—¶é—´è¿è¡Œ**: ä½¿ç”¨ `nohup` åå°è¿è¡Œï¼Œå®šæœŸæ£€æŸ¥æ—¥å¿—
4. **å¤šæ•°æ®é›†**: ä½¿ç”¨å¤šä¸ª `--input_dirs` æ··åˆæ•°æ®é›†
5. **å¯é‡å¤æ€§**: ä½¿ç”¨å›ºå®šçš„ `--random_seed`

---

**ç‰ˆæœ¬**: 2.0  
**æœ€åæ›´æ–°**: 2026-02-11  
**å…¼å®¹æ€§**: full_process_m3 æ‰€æœ‰ç‰ˆæœ¬
